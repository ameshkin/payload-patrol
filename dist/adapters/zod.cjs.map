{"version":3,"sources":["../../src/adapters/zod.ts","../../src/lib/checks/registry.ts","../../data/en/severe.json","../../src/lib/checks/builtins/badwords.ts","../../src/lib/checks/builtins/sql.ts","../../src/lib/checks/builtins/scripts.ts","../../src/lib/checks/builtins/html.ts","../../src/lib/checks/builtins/limit.ts","../../src/lib/checks/builtins/sentiment.ts","../../src/lib/checks/builtins/index.ts","../../src/lib/checks/run.ts","../../src/index.ts"],"sourcesContent":["/**\n * Zod adapter for Payload Patrol\n * Lightweight integration for schema-level validation\n */\n\nimport { z } from \"zod\";\nimport { auditPayload } from \"../index\";\nimport type { CheckName, AdapterMode } from \"../types\";\n\nexport interface ZodSafeStringOptions {\n  /** Maximum string length */\n  maxLength?: number;\n  /** Minimum string length */\n  minLength?: number;\n  /** Block SQL injection patterns (default: true) */\n  blockSQLi?: boolean;\n  /** Block XSS/script patterns (default: true) */\n  blockXSS?: boolean;\n  /** Allow HTML tags (default: false) */\n  allowHTML?: boolean;\n  /** Check profanity (default: false) */\n  checkProfanity?: boolean;\n  /** Maximum character count */\n  maxChars?: number;\n  /** Maximum word count */\n  maxWords?: number;\n  /** Allowlist of terms */\n  allowlist?: string[];\n  /** Adapter mode (default: \"block\") */\n  adapter?: AdapterMode;\n  /** Custom error message */\n  message?: string;\n}\n\n/**\n * Create a safe string schema with Payload Patrol validation\n * \n * @example\n * ```ts\n * const schema = z.object({\n *   name: zSafeString({ maxLength: 128 }),\n *   email: zSafeString({ allowHTML: false }),\n *   bio: zSafeString({ maxChars: 500, checkProfanity: true })\n * });\n * ```\n */\nexport function zSafeString(opts: ZodSafeStringOptions = {}) {\n  const {\n    maxLength,\n    minLength,\n    blockSQLi = true,\n    blockXSS = true,\n    allowHTML = false,\n    checkProfanity = false,\n    maxChars,\n    maxWords,\n    allowlist,\n    adapter = \"block\",\n    message,\n  } = opts;\n\n  let schema = z.string();\n\n  // Apply basic string validations\n  if (minLength !== undefined) {\n    schema = schema.min(minLength);\n  }\n  if (maxLength !== undefined) {\n    schema = schema.max(maxLength);\n  }\n\n  // Add Payload Patrol refinement\n  return schema.refine(\n    async (value) => {\n      const checks: CheckName[] = [];\n      \n      if (checkProfanity) checks.push(\"badwords\");\n      if (blockSQLi) checks.push(\"sql\");\n      if (blockXSS) checks.push(\"scripts\");\n      if (!allowHTML) checks.push(\"html\");\n      if (maxChars || maxWords) checks.push(\"limit\");\n\n      const result = await auditPayload(value, {\n        adapter,\n        checks,\n        context: {\n          limit: { maxChars, maxWords },\n          allowlist,\n        },\n      });\n\n      return result.ok;\n    },\n    {\n      message: message || \"Input contains unsafe content\",\n      // Provide detailed error via params\n      params: {\n        code: \"unsafe_content\",\n      },\n    }\n  );\n}\n\n/**\n * Create a safe object schema that validates all string fields\n * \n * @example\n * ```ts\n * const schema = zSafeObject({\n *   name: z.string(),\n *   email: z.string().email(),\n *   age: z.number()\n * }, { blockXSS: true, blockSQLi: true });\n * ```\n */\nexport function zSafeObject<T extends z.ZodRawShape>(\n  shape: T,\n  opts: Omit<ZodSafeStringOptions, \"maxLength\" | \"minLength\"> = {}\n) {\n  return z.object(shape).refine(\n    async (value) => {\n      const result = await auditPayload(value, {\n        adapter: opts.adapter || \"block\",\n        checks: [\n          ...(opts.checkProfanity ? [\"badwords\" as CheckName] : []),\n          ...(opts.blockSQLi !== false ? [\"sql\" as CheckName] : []),\n          ...(opts.blockXSS !== false ? [\"scripts\" as CheckName] : []),\n          ...(opts.allowHTML === false ? [\"html\" as CheckName] : []),\n        ],\n        context: {\n          limit: { maxChars: opts.maxChars, maxWords: opts.maxWords },\n          allowlist: opts.allowlist,\n        },\n      });\n      return result.ok;\n    },\n    {\n      message: opts.message || \"Object contains unsafe content\",\n      params: {\n        code: \"unsafe_content\",\n      },\n    }\n  );\n}\n\n/**\n * Transform that strips unsafe content instead of blocking\n * \n * @example\n * ```ts\n * const schema = z.string().transform(zStripUnsafe());\n * ```\n */\nexport function zStripUnsafe(opts: Omit<ZodSafeStringOptions, \"adapter\"> = {}) {\n  return async (value: string) => {\n    const checks: CheckName[] = [];\n    \n    if (opts.blockXSS !== false) checks.push(\"scripts\");\n    if (!opts.allowHTML) checks.push(\"html\");\n\n    const result = await auditPayload(value, {\n      adapter: \"strip\",\n      checks,\n      context: {\n        allowlist: opts.allowlist,\n      },\n    });\n\n    return (result.value as string) || value;\n  };\n}\n","const registry = new Map<string, { name: string; run: (v: string, ctx?: any) => any }>();\n\nexport function registerCheck(name: string, run: (value: string, ctx?: any) => any) {\n  registry.set(name, { name, run });\n}\n\nexport function getCheck(name: string) {\n  const found = registry.get(name);\n  if (!found) throw new Error(`Unknown check: ${name}`);\n  return found;\n}\n\nexport function hasCheck(name: string) {\n  return registry.has(name);\n}\n\nexport function listChecks() {\n  return [...registry.keys()];\n}\n","[\n  \"4r5e\",\n  \"5h1t\",\n  \"5hit\",\n  \"a55\",\n  \"anal\",\n  \"anus\",\n  \"ar5e\",\n  \"arrse\",\n  \"arse\",\n  \"ass\",\n  \"ass-fucker\",\n  \"asses\",\n  \"assfucker\",\n  \"assfukka\",\n  \"asshole\",\n  \"assholes\",\n  \"asswhole\",\n  \"a_s_s\",\n  \"b!tch\",\n  \"b00bs\",\n  \"b17ch\",\n  \"b1tch\",\n  \"ballbag\",\n  \"ballsack\",\n  \"bastard\",\n  \"beastial\",\n  \"beastiality\",\n  \"bellend\",\n  \"bestial\",\n  \"bestiality\",\n  \"bi+ch\",\n  \"biatch\",\n  \"bitch\",\n  \"bitcher\",\n  \"bitchers\",\n  \"bitches\",\n  \"bitchin\",\n  \"bitching\",\n  \"blow job\",\n  \"blowjob\",\n  \"blowjobs\",\n  \"bollock\",\n  \"bollok\",\n  \"boob\",\n  \"boobs\",\n  \"booobs\",\n  \"boooobs\",\n  \"booooobs\",\n  \"booooooobs\",\n  \"buceta\",\n  \"bugger\",\n  \"bunny fucker\",\n  \"butthole\",\n  \"buttmuch\",\n  \"buttplug\",\n  \"c0ck\",\n  \"c0cksucker\",\n  \"carpet muncher\",\n  \"cawk\",\n  \"chink\",\n  \"cipa\",\n  \"cl1t\",\n  \"clit\",\n  \"clitoris\",\n  \"clits\",\n  \"cnut\",\n  \"cock\",\n  \"cock-sucker\",\n  \"cockface\",\n  \"cockhead\",\n  \"cockmunch\",\n  \"cockmuncher\",\n  \"cocks\",\n  \"cocksuck\",\n  \"cocksucked\",\n  \"cocksucker\",\n  \"cocksucking\",\n  \"cocksucks\",\n  \"cocksuka\",\n  \"cocksukka\",\n  \"cok\",\n  \"cokmuncher\",\n  \"coksucka\",\n  \"coon\",\n  \"cox\",\n  \"cum\",\n  \"cummer\",\n  \"cumming\",\n  \"cums\",\n  \"cumshot\",\n  \"cunilingus\",\n  \"cunillingus\",\n  \"cunnilingus\",\n  \"cunt\",\n  \"cuntlick\",\n  \"cuntlicker\",\n  \"cuntlicking\",\n  \"cunts\",\n  \"cyberfuc\",\n  \"cyberfuck\",\n  \"cyberfucked\",\n  \"cyberfucker\",\n  \"cyberfuckers\",\n  \"cyberfucking\",\n  \"d1ck\",\n  \"dick\",\n  \"dickhead\",\n  \"dildo\",\n  \"dildos\",\n  \"dipshit\",\n  \"dlck\",\n  \"dog-fucker\",\n  \"doggin\",\n  \"dogging\",\n  \"donkeyribber\",\n  \"doosh\",\n  \"duche\",\n  \"douchebag\",\n  \"dyke\",\n  \"ejaculate\",\n  \"ejaculated\",\n  \"ejaculates\",\n  \"ejaculating\",\n  \"ejaculatings\",\n  \"ejaculation\",\n  \"ejakulate\",\n  \"f u c k\",\n  \"f u c k e r\",\n  \"f4nny\",\n  \"fag\",\n  \"fagging\",\n  \"faggitt\",\n  \"faggot\",\n  \"faggs\",\n  \"fagot\",\n  \"fagots\",\n  \"fags\",\n  \"fanny\",\n  \"fannyflaps\",\n  \"fannyfucker\",\n  \"fanyy\",\n  \"fatass\",\n  \"fcuk\",\n  \"fcuker\",\n  \"fcuking\",\n  \"feck\",\n  \"fecker\",\n  \"felching\",\n  \"fellate\",\n  \"fellatio\",\n  \"fingerfuck\",\n  \"fingerfucked\",\n  \"fingerfucker\",\n  \"fingerfuckers\",\n  \"fingerfucking\",\n  \"fingerfucks\",\n  \"fistfuck\",\n  \"fistfucked\",\n  \"fistfucker\",\n  \"fistfuckers\",\n  \"fistfucking\",\n  \"fistfuckings\",\n  \"fistfucks\",\n  \"flange\",\n  \"fook\",\n  \"fooker\",\n  \"fuck\",\n  \"fucka\",\n  \"fucked\",\n  \"fucker\",\n  \"fuckers\",\n  \"fuckface\",\n  \"fuckhead\",\n  \"fuckheads\",\n  \"fuckin\",\n  \"fucking\",\n  \"fuckings\",\n  \"fuckingshitmotherfucker\",\n  \"fuckme\",\n  \"fucks\",\n  \"fuckwhit\",\n  \"fuckwit\",\n  \"fudge packer\",\n  \"fudgepacker\",\n  \"fuk\",\n  \"fuker\",\n  \"fukker\",\n  \"fukkin\",\n  \"fuks\",\n  \"fukwhit\",\n  \"fukwit\",\n  \"fux\",\n  \"fux0r\",\n  \"f_u_c_k\",\n  \"gangbang\",\n  \"gangbanged\",\n  \"gangbangs\",\n  \"gaylord\",\n  \"gaysex\",\n  \"goatse\",\n  \"goddamn\",\n  \"goddamned\",\n  \"hardcoresex\",\n  \"heshe\",\n  \"hoar\",\n  \"hoare\",\n  \"hoer\",\n  \"homo\",\n  \"hore\",\n  \"horniest\",\n  \"horny\",\n  \"hotsex\",\n  \"jack-off\",\n  \"jackoff\",\n  \"jap\",\n  \"jerk-off\",\n  \"jism\",\n  \"jiz\",\n  \"jizm\",\n  \"jizz\",\n  \"kawk\",\n  \"knob\",\n  \"knobead\",\n  \"knobed\",\n  \"knobend\",\n  \"knobhead\",\n  \"knobjocky\",\n  \"knobjokey\",\n  \"kock\",\n  \"kondum\",\n  \"kondums\",\n  \"kum\",\n  \"kummer\",\n  \"kumming\",\n  \"kums\",\n  \"kunilingus\",\n  \"l3i+ch\",\n  \"l3itch\",\n  \"labia\",\n  \"m0f0\",\n  \"m0fo\",\n  \"m45terbate\",\n  \"ma5terb8\",\n  \"ma5terbate\",\n  \"masochist\",\n  \"master-bate\",\n  \"masterb8\",\n  \"masterbat*\",\n  \"masterbat3\",\n  \"masterbate\",\n  \"masterbation\",\n  \"masterbations\",\n  \"masturbate\",\n  \"mo-fo\",\n  \"mof0\",\n  \"mofo\",\n  \"mothafuck\",\n  \"mothafucka\",\n  \"mothafuckas\",\n  \"mothafuckaz\",\n  \"mothafucked\",\n  \"mothafucker\",\n  \"mothafuckers\",\n  \"mothafuckin\",\n  \"mothafucking\",\n  \"mothafuckings\",\n  \"mothafucks\",\n  \"mother fucker\",\n  \"motherfuck\",\n  \"motherfucked\",\n  \"motherfucker\",\n  \"motherfuckers\",\n  \"motherfuckin\",\n  \"motherfucking\",\n  \"motherfuckings\",\n  \"motherfuckka\",\n  \"motherfucks\",\n  \"muff\",\n  \"mutha\",\n  \"muthafecker\",\n  \"muthafuckker\",\n  \"muther\",\n  \"mutherfucker\",\n  \"n1gga\",\n  \"n1gger\",\n  \"nazi\",\n  \"nigg3r\",\n  \"nigg4h\",\n  \"nigga\",\n  \"niggah\",\n  \"niggas\",\n  \"niggaz\",\n  \"nigger\",\n  \"niggers\",\n  \"nob\",\n  \"nob jokey\",\n  \"nobhead\",\n  \"nobjocky\",\n  \"nobjokey\",\n  \"numbnuts\",\n  \"nutsack\",\n  \"orgasim\",\n  \"orgasims\",\n  \"orgasm\",\n  \"orgasms\",\n  \"p0rn\",\n  \"pecker\",\n  \"penis\",\n  \"penisfucker\",\n  \"phonesex\",\n  \"phuck\",\n  \"phuk\",\n  \"phuked\",\n  \"phuking\",\n  \"phukked\",\n  \"phukking\",\n  \"phuks\",\n  \"phuq\",\n  \"pigfucker\",\n  \"pimpis\",\n  \"piss\",\n  \"pissed\",\n  \"pisser\",\n  \"pissers\",\n  \"pisses\",\n  \"pissflaps\",\n  \"pissin\",\n  \"pissing\",\n  \"pissoff\",\n  \"poop\",\n  \"porn\",\n  \"porno\",\n  \"pornography\",\n  \"pornos\",\n  \"prick\",\n  \"pricks\",\n  \"pron\",\n  \"pube\",\n  \"pusse\",\n  \"pussi\",\n  \"pussies\",\n  \"pussy\",\n  \"pussys\",\n  \"rectum\",\n  \"retard\",\n  \"rimjaw\",\n  \"rimming\",\n  \"s hit\",\n  \"s.o.b.\",\n  \"sadist\",\n  \"schlong\",\n  \"screwing\",\n  \"scroat\",\n  \"scrote\",\n  \"scrotum\",\n  \"semen\",\n  \"sh!+\",\n  \"sh!t\",\n  \"sh1t\",\n  \"shag\",\n  \"shagger\",\n  \"shaggin\",\n  \"shagging\",\n  \"shemale\",\n  \"shi+\",\n  \"shit\",\n  \"shitbag\",\n  \"shitdick\",\n  \"shite\",\n  \"shited\",\n  \"shitey\",\n  \"shitface\",\n  \"shitfuck\",\n  \"shitfull\",\n  \"shithead\",\n  \"shiting\",\n  \"shitings\",\n  \"shits\",\n  \"shitted\",\n  \"shitter\",\n  \"shitters\",\n  \"shitting\",\n  \"shittings\",\n  \"shitty\",\n  \"skank\",\n  \"slut\",\n  \"sluts\",\n  \"smegma\",\n  \"smut\",\n  \"snatch\",\n  \"son-of-a-bitch\",\n  \"spac\",\n  \"spunk\",\n  \"s_h_i_t\",\n  \"t1tt1e5\",\n  \"t1tties\",\n  \"teets\",\n  \"teez\",\n  \"testical\",\n  \"testicle\",\n  \"tit\",\n  \"titfuck\",\n  \"tits\",\n  \"titt\",\n  \"tittie5\",\n  \"tittiefucker\",\n  \"titties\",\n  \"tittyfuck\",\n  \"tittywank\",\n  \"titwank\",\n  \"tosser\",\n  \"turd\",\n  \"tw4t\",\n  \"twat\",\n  \"twathead\",\n  \"twatty\",\n  \"twunt\",\n  \"twunter\",\n  \"v14gra\",\n  \"v1gra\",\n  \"vagina\",\n  \"viagra\",\n  \"vulva\",\n  \"w00se\",\n  \"wang\",\n  \"wank\",\n  \"wanker\",\n  \"wanky\",\n  \"whore\",\n  \"xrated\",\n  \"xxx\"\n]\n\n","import badwordsSevereData from \"../../../../data/en/severe.json\";\nimport type { CheckFn } from \"../../../types\";\n\n// NOTE: Uses English severe profanity by default. Use registerBadwords() to customize.\nconst badwordsSevere = badwordsSevereData as string[];\nconst defaultBadSet = new Set(badwordsSevere.map(w => w.toLowerCase()));\n\n// Allow runtime registration of additional profanity\nlet customBadwords: Set<string> | null = null;\n\nexport function registerBadwords(words: string[]) {\n  customBadwords = new Set(words.map(w => w.toLowerCase()));\n}\n\nexport const badwordsCheck: CheckFn = (value, ctx) => {\n  // Merge default and custom badwords\n  const badSet = customBadwords || defaultBadSet;\n  \n  const allow = new Set((ctx?.allowlist ?? []).map(w => w.toLowerCase()));\n  const tokens = value.toLowerCase().match(/[a-z0-9@.\\-_'']+/g) ?? [];\n  const hits: string[] = [];\n  for (let i = 0; i < tokens.length; i++) {\n    const t = tokens[i];\n    if (allow.has(t)) continue;\n    if (badSet.has(t)) hits.push(t);\n  }\n  const uniqueHits = Array.from(new Set(hits));\n  return {\n    name: \"badwords\",\n    ok: hits.length === 0,\n    message: hits.length ? `Contains blocked terms: ${uniqueHits.slice(0, 5).join(\", \")}` : undefined,\n    details: hits.length ? { hits: uniqueHits } : undefined,\n  };\n};\n","import type { CheckFn } from \"../../../types\";\n\n// Heuristic detection of SQL injection-y patterns.\nconst suspicious = [\n  /\\bunion\\b\\s+\\bselect\\b/i,\n  /\\bselect\\b.+\\bfrom\\b/i,\n  /(--|#).+$/m,\n  /\\/\\*[\\s\\S]*?\\*\\//,\n  /\\bor\\s+1\\s*=\\s*1\\b/i,\n  /\\bdrop\\s+(table|database)\\b/i,\n  /\\binsert\\s+into\\b/i,\n  /\\bupdate\\b.+\\bset\\b/i,\n  /\\bdelete\\s+from\\b/i,\n  /\\bsleep\\s*\\(/i,\n  /\\bxp_cmdshell\\b/i,\n  /;{2,}/,\n];\n\nexport const sqlCheck: CheckFn = (value) => {\n  const hits = suspicious.filter(rx => rx.test(value)).map(rx => rx.source).slice(0, 5);\n  return {\n    name: \"sql\",\n    ok: hits.length === 0,\n    message: hits.length ? \"Looks like SQL or injection patterns.\" : undefined,\n    details: hits.length ? { rules: hits } : undefined,\n  };\n};\n","import type { CheckFn } from \"../../../types\";\n\nconst rx = [\n  /<\\s*script\\b/i,\n  /\\bon[a-z]+\\s*=/i, // onclick= onload= â€¦\n  /\\bjavascript\\s*:/i,\n  /\\bdocument\\./i,\n  /\\bwindow\\./i,\n  /\\beval\\s*\\(/i,\n];\n\nexport const scriptsCheck: CheckFn = (value) => {\n  const hits = rx.filter(r => r.test(value)).map(r => r.source);\n// inside scriptsCheck\n  const stripRules = [/<\\s*script\\b[^>]*>[\\s\\S]*?<\\s*\\/\\s*script\\s*>/gi, /\\bon[a-z]+\\s*=\\s*[\"'][^\"']*[\"']/gi, /\\bjavascript\\s*:[^)\\s]+/gi];\n  const stripped = value.replace(stripRules[0], \"\").replace(stripRules[1], \"\").replace(stripRules[2], \"\");\n  return {\n    name: \"scripts\",\n    ok: hits.length === 0,\n    message: hits.length ? \"Inline script/event handler detected.\" : undefined,\n    details: hits.length ? { rules: hits } : undefined,\n    value: stripped, // enables adapter: 'strip'\n  };\n\n};\n","import type { CheckFn } from \"../../../types\";\n\n// Allow extremely limited markup; otherwise flag.\nconst ALLOW = new Set([\"b\", \"i\", \"u\", \"strong\", \"em\", \"br\", \"span\"]);\nconst TAG_RX = /<\\s*\\/?\\s*([a-z0-9:-]+)[^>]*>/gi;\n\nexport const htmlCheck: CheckFn = (value) => {\n  let m: RegExpExecArray | null;\n  const bad: string[] = [];\n  while ((m = TAG_RX.exec(value))) {\n    const tag = (m[1] || \"\").toLowerCase();\n    if (!ALLOW.has(tag)) bad.push(tag);\n  }\n  const uniqueBad = Array.from(new Set(bad));\n  return {\n    name: \"html\",\n    ok: bad.length === 0,\n    message: bad.length ? `HTML not allowed: ${uniqueBad.slice(0, 5).join(\", \")}` : undefined,\n    details: bad.length ? { tags: uniqueBad } : undefined,\n  };\n};\n","import type { CheckFn } from \"../../../types\";\n\nexport const limitCheck: CheckFn = (value, ctx) => {\n  const maxChars = ctx?.limit?.maxChars ?? 0;\n  const maxWords = ctx?.limit?.maxWords ?? 0;\n  const words = value.trim().split(/\\s+/).filter(Boolean);\n  const charFail = maxChars > 0 && value.length > maxChars;\n  const wordFail = maxWords > 0 && words.length > maxWords;\n\n  return {\n    name: \"limit\",\n    ok: !charFail && !wordFail,\n    message: charFail\n      ? `Too long (${value.length}/${maxChars} chars).`\n      : wordFail\n        ? `Too many words (${words.length}/${maxWords}).`\n        : undefined,\n    details: { length: value.length, words: words.length, maxChars, maxWords },\n  };\n};\n","import type { CheckFn } from \"../../../types\";\n\n// Lightweight sentiment analysis without external dependencies\n// Uses AFINN-inspired word lists for basic sentiment scoring\n\nconst POSITIVE_WORDS = new Set([\n  \"good\", \"great\", \"excellent\", \"amazing\", \"wonderful\", \"fantastic\", \"awesome\", \"love\", \"like\",\n  \"happy\", \"joy\", \"pleased\", \"delighted\", \"thrilled\", \"excited\", \"brilliant\", \"perfect\",\n  \"beautiful\", \"nice\", \"best\", \"super\", \"fabulous\", \"terrific\", \"outstanding\", \"impressive\",\n  \"glad\", \"thank\", \"thanks\", \"appreciate\", \"enjoy\", \"fun\", \"exceeded\", \"exceeds\", \"quality\"\n]);\n\nconst NEGATIVE_WORDS = new Set([\n  \"bad\", \"terrible\", \"awful\", \"horrible\", \"worst\", \"hate\", \"dislike\", \"angry\", \"sad\",\n  \"disappointed\", \"frustrated\", \"annoyed\", \"upset\", \"unhappy\", \"poor\", \"sucks\", \"useless\",\n  \"waste\", \"fail\", \"failed\", \"wrong\", \"problem\", \"issue\", \"concern\", \"worried\", \"fear\",\n  \"afraid\", \"scary\", \"difficult\", \"hard\", \"confusing\", \"broken\", \"error\"\n]);\n\nconst INTENSIFIERS = new Set([\n  \"very\", \"extremely\", \"really\", \"super\", \"incredibly\", \"absolutely\", \"totally\", \"completely\"\n]);\n\nconst NEGATIONS = new Set([\n  \"not\", \"no\", \"never\", \"none\", \"nobody\", \"nothing\", \"neither\", \"nowhere\", \"hardly\", \"barely\"\n]);\n\nexport interface SentimentResult {\n  score: number;        // -5 to +5\n  comparative: number;  // score / tokens (normalized)\n  mood: \"negative\" | \"neutral\" | \"positive\";\n  tokens: number;\n  positive: string[];\n  negative: string[];\n}\n\n/**\n * Analyze sentiment of text and return detailed results\n */\nexport function analyzeSentiment(text: string): SentimentResult {\n  const tokens = text.toLowerCase().match(/[a-z']+/g) || [];\n  let score = 0;\n  const positive: string[] = [];\n  const negative: string[] = [];\n  \n  let nextNegated = false;\n  let nextIntensified = false;\n\n  for (let i = 0; i < tokens.length; i++) {\n    const token = tokens[i];\n    let tokenScore = 0;\n\n    if (NEGATIONS.has(token)) {\n      nextNegated = true;\n      continue;\n    }\n\n    if (INTENSIFIERS.has(token)) {\n      nextIntensified = true;\n      continue;\n    }\n\n    if (POSITIVE_WORDS.has(token)) {\n      tokenScore = 1;\n      positive.push(token);\n    } else if (NEGATIVE_WORDS.has(token)) {\n      tokenScore = -1;\n      negative.push(token);\n    }\n\n    // Apply modifiers\n    if (nextIntensified) {\n      tokenScore *= 2;\n      nextIntensified = false;\n    }\n\n    if (nextNegated) {\n      tokenScore *= -1;\n      nextNegated = false;\n    }\n\n    score += tokenScore;\n  }\n\n  const comparative = tokens.length > 0 ? score / tokens.length : 0;\n  \n  let mood: \"negative\" | \"neutral\" | \"positive\";\n  if (comparative < -0.1) mood = \"negative\";\n  else if (comparative > 0.1) mood = \"positive\";\n  else mood = \"neutral\";\n\n  return {\n    score,\n    comparative,\n    mood,\n    tokens: tokens.length,\n    positive,\n    negative,\n  };\n}\n\n/**\n * Sentiment check - can be used to warn about negative sentiment\n * or just to analyze mood without blocking\n */\nexport const sentimentCheck: CheckFn = (value, ctx) => {\n  const analysis = analyzeSentiment(value);\n  \n  // By default, sentiment check is informational (always passes)\n  // But provides rich details for UI components\n  return {\n    name: \"sentiment\",\n    ok: true, // Always passes - informational only\n    message: undefined,\n    details: {\n      mood: analysis.mood,\n      score: analysis.score,\n      comparative: analysis.comparative,\n      positive: analysis.positive,\n      negative: analysis.negative,\n      tokens: analysis.tokens,\n    },\n  };\n};\n\n","import { registerCheck } from \"../registry\";\nimport { badwordsCheck } from \"./badwords\";\nimport { sqlCheck } from \"./sql\";\nimport { scriptsCheck } from \"./scripts\";\nimport { htmlCheck } from \"./html\";\nimport { limitCheck } from \"./limit\";\nimport { sentimentCheck } from \"./sentiment\";\n\nexport function registerBuiltins() {\n  registerCheck(\"badwords\", badwordsCheck);\n  registerCheck(\"sql\", sqlCheck);\n  registerCheck(\"scripts\", scriptsCheck);\n  registerCheck(\"html\", htmlCheck);\n  registerCheck(\"limit\", limitCheck);\n  registerCheck(\"sentiment\", sentimentCheck);\n}\n\n// Export for direct use\nexport { analyzeSentiment } from \"./sentiment\";\nexport type { SentimentResult } from \"./sentiment\";\n","import { getCheck } from \"./registry\";\nimport type { AdapterMode, CheckContext, CheckName, RunChecksOptions, RunChecksResult } from \"../../types\";\n\n/**\n * runChecks\n * Inputs: value (string), list of check names, optional context and adapter options.\n * Output: aggregate result with per-check results and possibly sanitized value.\n */\nexport async function runChecks(\n  value: string,\n  checks: Array<CheckName>,\n  ctx?: CheckContext,\n  opts?: RunChecksOptions\n): Promise<RunChecksResult> {\n  const mode: AdapterMode = opts?.adapter ?? \"block\";\n  const stopOnFirstBlock = opts?.stopOnFirstBlock ?? true;\n\n  let current = value;\n  const results = [];\n\n  for (const name of checks) {\n    const { run } = getCheck(name);\n    const res = await Promise.resolve(run(current, ctx));\n    results.push(res);\n\n    if (!res.ok) {\n      if (mode === \"strip\" && typeof res.value === \"string\") {\n        current = res.value;\n        continue;\n      }\n      if (mode === \"block\" && stopOnFirstBlock) {\n        return { ok: false, results, value: current };\n      }\n    }\n  }\n\n  const ok = results.every(r => r.ok || mode === \"strip\");\n  return { ok, results, value: current };\n}\n\n/**\n * adaptStrip\n * Inputs: original value and regexes to remove.\n * Output: sanitized value with patterns stripped.\n */\nexport function adaptStrip(value: string, patterns: RegExp[]) {\n  let out = value;\n  for (const p of patterns) out = out.replace(p, \"\");\n  return out;\n}\n","/**\n * Payload Patrol - Headless input defense\n * Framework-agnostic validation for web apps and APIs\n */\n\nimport { registerBuiltins } from \"./lib/checks/builtins/index\";\nimport { runChecks } from \"./lib/checks/run\";\nimport type {\n  CheckName,\n  CheckContext,\n  CheckResult,\n  RunChecksOptions,\n  RunChecksResult,\n  AdapterMode,\n} from \"./types\";\n\n// Auto-register built-in checks on module load\nregisterBuiltins();\n\n// Re-export types\nexport type {\n  CheckName,\n  CheckContext,\n  CheckResult,\n  RunChecksOptions,\n  RunChecksResult,\n  AdapterMode,\n};\n\n// Re-export from internal for profanity management\nexport { registerProfanityList } from \"./internal\";\n\n// Re-export registry for custom checks\nexport { registerCheck, getCheck, hasCheck, listChecks } from \"./lib/checks/registry\";\n\n// Re-export sentiment analysis\nexport { analyzeSentiment } from \"./lib/checks/builtins/index\";\nexport type { SentimentResult } from \"./lib/checks/builtins/index\";\n\n// Re-export runChecks for direct use\nexport { runChecks };\n\n/**\n * Options for creating a patrol instance\n */\nexport interface PatrolOptions {\n  /** Block SQL injection patterns (default: true) */\n  blockSQLi?: boolean;\n  /** Block XSS/script patterns (default: true) */\n  blockXSS?: boolean;\n  /** Allow HTML tags (default: false) */\n  allowHTML?: boolean;\n  /** Character and word limits */\n  limit?: { maxChars?: number; maxWords?: number };\n  /** Allowlist of terms that bypass badwords check */\n  allowlist?: string[];\n  /** Adapter mode: block, warn, or strip (default: \"block\") */\n  adapter?: AdapterMode;\n  /** Enable profanity checking (default: false) */\n  checkProfanity?: boolean;\n}\n\n/**\n * Result of scanning a payload\n */\nexport interface ScanResult {\n  /** Whether the payload passed all checks */\n  ok: boolean;\n  /** Array of issues found (path + check result) */\n  issues: Array<{\n    path: (string | number)[];\n    rule: CheckName;\n    message?: string;\n    details?: Record<string, unknown>;\n  }>;\n  /** Sanitized value (when adapter=\"strip\") */\n  value?: unknown;\n}\n\n/**\n * Create a patrol instance with specific configuration\n * \n * @example\n * ```ts\n * const patrol = createPatrol({\n *   blockSQLi: true,\n *   blockXSS: true,\n *   allowHTML: false,\n *   limit: { maxChars: 5000, maxWords: 800 }\n * });\n * \n * const result = await patrol.scan({ name: \"Alice\", comment: \"Hello world\" });\n * if (!result.ok) {\n *   console.log(result.issues);\n * }\n * ```\n */\nexport function createPatrol(options: PatrolOptions = {}) {\n  const {\n    blockSQLi = true,\n    blockXSS = true,\n    allowHTML = false,\n    limit,\n    allowlist,\n    adapter = \"block\",\n    checkProfanity = false,\n  } = options;\n\n  // Build the checks array based on options\n  const checks: CheckName[] = [];\n  \n  if (checkProfanity) {\n    checks.push(\"badwords\");\n  }\n  if (blockSQLi) {\n    checks.push(\"sql\");\n  }\n  if (blockXSS) {\n    checks.push(\"scripts\");\n  }\n  if (!allowHTML) {\n    checks.push(\"html\");\n  }\n  if (limit) {\n    checks.push(\"limit\");\n  }\n\n  const context: CheckContext = {\n    limit,\n    allowlist,\n  };\n\n  const runOptions: RunChecksOptions = {\n    adapter,\n    stopOnFirstBlock: adapter === \"block\",\n  };\n\n  /**\n   * Scan a value or object for security issues\n   * @param value - String, object, or array to scan\n   * @param opts - Override options for this scan\n   */\n  async function scan(\n    value: unknown,\n    opts?: { adapter?: AdapterMode }\n  ): Promise<ScanResult> {\n    const scanAdapter = opts?.adapter ?? adapter;\n    const scanOptions: RunChecksOptions = {\n      ...runOptions,\n      adapter: scanAdapter,\n    };\n\n    const issues: ScanResult[\"issues\"] = [];\n\n    // Handle different value types\n    if (typeof value === \"string\") {\n      const result = await runChecks(value, checks, context, scanOptions);\n      if (!result.ok) {\n        for (const r of result.results) {\n          if (!r.ok) {\n            issues.push({\n              path: [],\n              rule: r.name,\n              message: r.message,\n              details: r.details,\n            });\n          }\n        }\n      }\n      return {\n        ok: result.ok,\n        issues,\n        value: scanAdapter === \"strip\" ? result.value : undefined,\n      };\n    }\n\n    // Handle arrays\n    if (Array.isArray(value)) {\n      let allOk = true;\n      const scannedArray: unknown[] = [];\n\n      for (let i = 0; i < value.length; i++) {\n        if (typeof value[i] === \"string\") {\n          const result = await runChecks(value[i], checks, context, scanOptions);\n          if (!result.ok) {\n            allOk = false;\n            for (const r of result.results) {\n              if (!r.ok) {\n                issues.push({\n                  path: [i],\n                  rule: r.name,\n                  message: r.message,\n                  details: r.details,\n                });\n              }\n            }\n          }\n          scannedArray.push(scanAdapter === \"strip\" ? result.value : value[i]);\n        } else if (typeof value[i] === \"object\") {\n          const nested = await scan(value[i], opts);\n          if (!nested.ok) {\n            allOk = false;\n            for (const issue of nested.issues) {\n              issues.push({\n                ...issue,\n                path: [i, ...issue.path],\n              });\n            }\n          }\n          scannedArray.push(scanAdapter === \"strip\" ? nested.value : value[i]);\n        } else {\n          scannedArray.push(value[i]);\n        }\n      }\n\n      return {\n        ok: allOk,\n        issues,\n        value: scanAdapter === \"strip\" ? scannedArray : undefined,\n      };\n    }\n\n    // Handle objects\n    if (value && typeof value === \"object\") {\n      let allOk = true;\n      const scannedObj: Record<string, unknown> = {};\n\n      for (const [key, val] of Object.entries(value)) {\n        if (typeof val === \"string\") {\n          const result = await runChecks(val, checks, context, scanOptions);\n          if (!result.ok) {\n            allOk = false;\n            for (const r of result.results) {\n              if (!r.ok) {\n                issues.push({\n                  path: [key],\n                  rule: r.name,\n                  message: r.message,\n                  details: r.details,\n                });\n              }\n            }\n          }\n          scannedObj[key] = scanAdapter === \"strip\" ? result.value : val;\n        } else if (typeof val === \"object\") {\n          const nested = await scan(val, opts);\n          if (!nested.ok) {\n            allOk = false;\n            for (const issue of nested.issues) {\n              issues.push({\n                ...issue,\n                path: [key, ...issue.path],\n              });\n            }\n          }\n          scannedObj[key] = scanAdapter === \"strip\" ? nested.value : val;\n        } else {\n          scannedObj[key] = val;\n        }\n      }\n\n      return {\n        ok: allOk,\n        issues,\n        value: scanAdapter === \"strip\" ? scannedObj : undefined,\n      };\n    }\n\n    // Non-string, non-object values pass through\n    return {\n      ok: true,\n      issues: [],\n      value: scanAdapter === \"strip\" ? value : undefined,\n    };\n  }\n\n  return {\n    scan,\n  };\n}\n\n/**\n * Quick audit of a single value without creating a patrol instance\n * Useful for one-off validations\n * \n * @example\n * ```ts\n * const result = await auditPayload(\"Hello <script>alert(1)</script>\", {\n *   adapter: \"warn\",\n *   checks: [\"scripts\", \"html\"]\n * });\n * ```\n */\nexport async function auditPayload(\n  value: unknown,\n  options: {\n    adapter?: AdapterMode;\n    checks?: CheckName[];\n    context?: CheckContext;\n  } = {}\n): Promise<ScanResult> {\n  const {\n    adapter = \"block\",\n    checks = [\"badwords\", \"sql\", \"scripts\", \"html\"],\n    context = {},\n  } = options;\n\n  const patrol = createPatrol({\n    adapter,\n    blockSQLi: checks.includes(\"sql\"),\n    blockXSS: checks.includes(\"scripts\"),\n    allowHTML: !checks.includes(\"html\"),\n    checkProfanity: checks.includes(\"badwords\"),\n    limit: context.limit,\n    allowlist: context.allowlist,\n  });\n\n  return patrol.scan(value, { adapter });\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAKA,iBAAkB;;;ACLlB,IAAM,WAAW,oBAAI,IAAkE;AAEhF,SAAS,cAAc,MAAc,KAAwC;AAClF,WAAS,IAAI,MAAM,EAAE,MAAM,IAAI,CAAC;AAClC;AAEO,SAAS,SAAS,MAAc;AACrC,QAAM,QAAQ,SAAS,IAAI,IAAI;AAC/B,MAAI,CAAC,MAAO,OAAM,IAAI,MAAM,kBAAkB,IAAI,EAAE;AACpD,SAAO;AACT;;;ACVA;AAAA,EACE;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AA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","names":["rx"]}